# Internationalization (i18n) Documentation

## Overview

This document describes the internationalization implementation for the Photo Book Creator application. The app supports multiple languages to provide a better user experience for international users.

## Technology Stack

- **next-i18next** - Internationalization library for Next.js applications
- **i18next** - Core internationalization framework
- **react-i18next** - React bindings for i18next

## Language Support

Currently supported languages:
- English (default)
- Spanish
- French
- German
- Japanese

## Directory Structure

```
apps/frontend/
├── public/
│   └── locales/
│       ├── en/
│       │   ├── common.json
│       │   ├── home.json
│       │   ├── design.json
│       │   ├── gallery.json
│       │   ├── products.json
│       │   ├── cart.json
│       │   ├── checkout.json
│       │   ├── account.json
│       │   └── dashboard.json
│       ├── es/
│       │   ├── common.json
│       │   └── ... (same structure as en)
│       ├── fr/
│       │   ├── common.json
│       │   └── ... (same structure as en)
│       ├── de/
│       │   ├── common.json
│       │   └── ... (same structure as en)
│       └── ja/
│           ├── common.json
│           └── ... (same structure as en)
├── lib/
│   └── i18n.ts
└── middleware.ts
```

## Configuration

### i18n Configuration (`apps/frontend/lib/i18n.ts`)

```typescript
import { serverSideTranslations } from 'next-i18next/serverSideTranslations';
import { appWithTranslation } from 'next-i18next';

export const i18nConfig = {
  i18n: {
    defaultLocale: 'en',
    locales: ['en', 'es', 'fr', 'de', 'ja'],
  },
  reloadOnPrerender: process.env.NODE_ENV === 'development',
};

export async function getI18nProps(locale: string, namespacesRequired: string[] = ['common']) {
  return {
    ...(await serverSideTranslations(locale, namespacesRequired)),
  };
}

export { appWithTranslation };
```

### Middleware Configuration (`apps/frontend/middleware.ts`)

```typescript
import { i18nConfig } from './lib/i18n';
import { i18n } from 'next-i18next';

export function middleware(request: NextRequest) {
  // i18n middleware logic
  return i18n.handle(request);
}

export const config = {
  matcher: [
    '/((?!api|_next/static|_next/image|favicon.ico).*)',
  ],
};
```

## Implementation

### Page-Level Implementation

```typescript
// pages/index.tsx
import { useTranslation } from 'next-i18next';
import { getI18nProps } from '../lib/i18n';

export default function Home() {
  const { t } = useTranslation('home');

  return (
    <div>
      <h1>{t('welcome')}</h1>
      <p>{t('description')}</p>
    </div>
  );
}

export async function getStaticProps({ locale }: { locale: string }) {
  return {
    props: {
      ...(await getI18nProps(locale, ['home', 'common'])),
    },
  };
}
```

### Component-Level Implementation

```typescript
// components/Header.tsx
import { useTranslation } from 'next-i18next';

export default function Header() {
  const { t } = useTranslation('common');

  return (
    <header>
      <h1>{t('app_name')}</h1>
      <nav>
        <a href="/">{t('navigation.home')}</a>
        <a href="/design">{t('navigation.design')}</a>
        <a href="/gallery">{t('navigation.gallery')}</a>
      </nav>
    </header>
  );
}
```

## Translation Files

### Common Namespace (`public/locales/en/common.json`)

```json
{
  "app_name": "Photo Book Creator",
  "navigation": {
    "home": "Home",
    "design": "Design",
    "gallery": "Gallery",
    "products": "Products",
    "cart": "Cart",
    "account": "Account"
  },
  "buttons": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit"
  },
  "messages": {
    "loading": "Loading...",
    "error": "An error occurred",
    "success": "Operation completed successfully"
  }
}
```

### Page-Specific Namespace (`public/locales/en/home.json`)

```json
{
  "welcome": "Welcome to Photo Book Creator",
  "description": "Create beautiful photo books with our easy-to-use design tool",
  "cta": {
    "start_creating": "Start Creating",
    "view_products": "View Products"
  },
  "features": {
    "title": "Features",
    "description": "Everything you need to create perfect photo books"
  }
}
```

## Language Switcher Component

```typescript
// components/LanguageSwitcher.tsx
import { useTranslation } from 'next-i18next';
import Link from 'next/link';
import { useRouter } from 'next/router';

export default function LanguageSwitcher() {
  const { i18n } = useTranslation();
  const router = useRouter();
  const { pathname, asPath, query } = router;

  const changeLanguage = (locale: string) => {
    router.push({ pathname, query }, asPath, { locale });
  };

  return (
    <div className="language-switcher">
      {i18nConfig.i18n.locales.map((locale) => (
        <button
          key={locale}
          onClick={() => changeLanguage(locale)}
          className={i18n.language === locale ? 'active' : ''}
        >
          {locale.toUpperCase()}
        </button>
      ))}
    </div>
  );
}
```

## Adding New Languages

### Steps to Add a New Language:

1. **Add language code to configuration**:
   ```typescript
   // lib/i18n.ts
   export const i18nConfig = {
     i18n: {
       defaultLocale: 'en',
       locales: ['en', 'es', 'fr', 'de', 'ja', 'new_lang'], // Add new language
     },
   };
   ```

2. **Create translation directories**:
   ```bash
   mkdir -p public/locales/new_lang
   ```

3. **Copy and translate JSON files**:
   ```bash
   cp public/locales/en/*.json public/locales/new_lang/
   # Translate the copied files
   ```

4. **Update language switcher** (if hardcoded):
   ```typescript
   // Add the new language to the switcher component
   ```

## Best Practices

### 1. Namespace Organization
- Use separate namespaces for different sections/pages
- Keep common translations in the `common` namespace
- Organize translations by feature or component

### 2. Key Naming Conventions
- Use descriptive, hierarchical keys
- Follow the pattern: `page.section.element`
- Avoid deeply nested structures

### 3. Translation Maintenance
- Keep translations in sync across languages
- Use translation management tools for large projects
- Regularly review and update translations

### 4. Dynamic Content
- Use interpolation for dynamic values:
  ```json
  {
    "items_count": "You have {{count}} items in your cart"
  }
  ```

### 5. Pluralization
- Use i18next pluralization features:
  ```json
  {
    "item_count": "{{count}} item",
    "item_count_plural": "{{count}} items"
  }
  ```

## Testing

### Language Switching Tests
```typescript
// __tests__/i18n.test.ts
import { render, screen } from '@testing-library/react';
import Home from '../pages/index';
import { appWithTranslation } from 'next-i18next';

describe('Internationalization', () => {
  it('should display English content by default', async () => {
    render(appWithTranslation(Home));
    expect(screen.getByText('Welcome to Photo Book Creator')).toBeInTheDocument();
  });

  it('should display Spanish content when locale is es', async () => {
    // Mock router with Spanish locale
    // Render component
    // Check for Spanish translations
  });
});
```

## Performance Considerations

### 1. Bundle Size
- Only load translations for the current language
- Use code splitting for translation files
- Optimize JSON translation files

### 2. Caching
- Leverage browser caching for translation files
- Use CDN for serving translation files
- Implement cache invalidation strategies

### 3. Server-Side Rendering
- Preload translations on the server
- Avoid client-side translation loading delays
- Use `getStaticProps` or `getServerSideProps` for translations

## Accessibility

### 1. Language Attributes
- Set proper `lang` attribute on HTML elements
- Update language attribute when switching languages
- Use `dir` attribute for RTL languages

### 2. Screen Readers
- Ensure translations are properly read by screen readers
- Test with different screen reader software
- Provide context for translated content

## Future Enhancements

### 1. Automated Translation
- Integration with translation APIs (Google Translate, DeepL)
- Automated translation workflows
- Translation quality checks

### 2. Translation Management
- Integration with translation management platforms
- Collaborative translation workflows
- Translation progress tracking

### 3. Advanced Features
- Right-to-left language support
- Language-specific formatting (dates, numbers, currencies)
- Cultural adaptations beyond text translation